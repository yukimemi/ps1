& { param([string]$path = (Read-Host "Path")); if ([string]::IsNullOrEmpty($path)) { $path = "." }; Get-ChildItem -Directory -Force $path | ForEach-Object { Write-Host "Get size: [$($_.FullName)] ..."; Get-ChildItem -Force -Recurse $_ | Measure-Object -Sum -Property Length | Set-Variable child; [PSCustomObject]@{ Path = $_.FullName; Count = $child.Count; Size = $child.Sum } } | Export-Csv -NoTypeInformation -Encoding utf8 dirsize.csv }
